### การเปลี่ยนแปลง (Drift) ใน Machine Learning: Data Drift, Model Drift และ Concept Drift

ในสาขา Machine Learning (ML) หรือการเรียนรู้ของเครื่อง การเปลี่ยนแปลงหรือ "Drift" เป็นปรากฏการณ์ที่เกิดขึ้นเมื่อโมเดลที่ถูกฝึกฝนแล้วต้องเผชิญกับข้อมูลหรือสภาพแวดล้อมที่เปลี่ยนไปจากตอนที่ฝึกฝน ทำให้ประสิทธิภาพของโมเดลลดลงตามเวลา Drift เหล่านี้เป็นปัญหาที่พบบ่อยในระบบ ML ที่ใช้งานจริง (production) โดยเฉพาะในแอปพลิเคชันที่ข้อมูลมีการเปลี่ยนแปลงแบบไดนามิก เช่น การพยากรณ์อากาศ การตรวจจับการฉ้อโกง หรือระบบแนะนำสินค้า หากไม่จัดการ Drift เหล่านี้ โมเดลอาจให้ผลลัพธ์ที่ไม่ถูกต้องหรือล้าสมัย

ในที่นี้ ผมจะอธิบายรายละเอียดเกี่ยวกับ Drift สามประเภทหลักที่คุณถาม ได้แก่ **Data Drift**, **Model Drift** และ **Concept Drift** โดยอธิบายทีละอย่าง รวมถึงสาเหตุ ตัวอย่าง วิธีตรวจจับ และวิธีแก้ไข เพื่อให้เข้าใจอย่างละเอียดยิ่งขึ้น โปรดทราบว่าในบางเอกสารหรือบริบท คำว่า "Model Drift" อาจถูกใช้แทนกันกับ "Performance Drift" หรือเป็นผลกระทบจาก Drift อื่นๆ แต่ผมจะอธิบายตามความหมายมาตรฐานในวงการ ML

#### 1. Data Drift (การเปลี่ยนแปลงข้อมูล)
Data Drift หมายถึงการเปลี่ยนแปลงในรูปแบบการกระจาย (distribution) ของข้อมูลนำเข้า (input data) ที่โมเดลได้รับ โดยที่ความสัมพันธ์ระหว่างข้อมูลนำเข้าและผลลัพธ์ (output) ยังคงเดิม แต่ตัวข้อมูลเองเปลี่ยนไป สาเหตุหลักเกิดจากข้อมูลในโลกจริงที่เปลี่ยนแปลงตามเวลา สภาพแวดล้อม หรือแหล่งข้อมูลใหม่ ทำให้ข้อมูลที่โมเดลเห็นในขั้นตอนการใช้งาน (inference) แตกต่างจากข้อมูลที่ใช้ฝึกฝน (training data)

**สาเหตุหลัก:**
- **การเปลี่ยนแปลงตามเวลา (Temporal Changes):** เช่น ข้อมูลยอดขายสินค้าที่เปลี่ยนตามฤดูกาล เช่น ในช่วงเทศกาลคริสต์มาส ยอดขายของเล่นเพิ่มขึ้น ทำให้ distribution ของข้อมูลเปลี่ยน
- **การเปลี่ยนแปลงแหล่งข้อมูล (Source Changes):** เช่น การรวบรวมข้อมูลจากแหล่งใหม่ เช่น จากเว็บไซต์ใหม่หรือเซ็นเซอร์ใหม่ที่วัดค่าแตกต่างกันเล็กน้อย
- **ปัญหาการสุ่มตัวอย่าง (Sampling Bias):** ข้อมูลใหม่ถูกสุ่มมาจากกลุ่มประชากรที่ต่างจากเดิม เช่น จากผู้ใช้ในเมืองใหญ่ไปเป็นผู้ใช้ในชนบท
- **ปัญหาทางเทคนิค:** เช่น เซ็นเซอร์ชำรุด ทำให้ข้อมูลมี noise เพิ่มขึ้น หรือรูปแบบข้อมูลเปลี่ยน (เช่น จากภาพสีไปเป็นภาพขาวดำ)

**ตัวอย่าง:**
- ในระบบตรวจจับการฉ้อโกงบัตรเครดิต ข้อมูลธุรกรรมปกติอาจเปลี่ยนไปตามพฤติกรรมผู้ใช้ เช่น ในช่วงโควิด-19 ผู้คนช้อปออนไลน์มากขึ้น ทำให้ distribution ของจำนวนเงินและประเภทธุรกรรมเปลี่ยน หากโมเดลฝึกด้วยข้อมูลก่อนโควิด มันอาจตรวจจับผิดพลาด
- ในแอปพลิเคชันวิเคราะห์ภาพ เช่น การตรวจจับวัตถุในภาพจากกล้องวงจรปิด หากข้อมูลฝึกเป็นภาพกลางวัน แต่ใช้งานจริงมีภาพกลางคืนมากขึ้น นี่คือ Data Drift

**วิธีตรวจจับ:**
- **สถิติเชิงพรรณนา (Descriptive Statistics):** เปรียบเทียบ mean, variance, min/max ของข้อมูลเก่าและใหม่
- **การทดสอบทางสถิติ:** เช่น Kolmogorov-Smirnov (KS) Test สำหรับ continuous data หรือ Chi-Square Test สำหรับ categorical data เพื่อตรวจสอบว่าการกระจายข้อมูลต่างกันอย่างมีนัยสำคัญหรือไม่
- **Visualization:** พล็อต histogram, box plot หรือ PCA (Principal Component Analysis) เพื่อดูความแตกต่าง
- **Monitoring Tools:** ใช้ไลบรารีอย่าง Evidently AI หรือ Alibi Detect เพื่อตรวจจับอัตโนมัติ

**วิธีแก้ไข:**
- **Retraining โมเดล:** ฝึกโมเดลใหม่ด้วยข้อมูลล่าสุดเป็นระยะ
- **Data Normalization:** ปรับข้อมูลใหม่ให้คล้ายข้อมูลเก่า เช่น ใช้ feature scaling
- **Ensemble Methods:** ใช้หลายโมเดลที่ฝึกกับข้อมูลต่างช่วงเวลา แล้วรวมผลลัพธ์
- **Monitoring ต่อเนื่อง:** ตั้งระบบแจ้งเตือนเมื่อ Drift เกิน threshold

#### 2. Model Drift (การเปลี่ยนแปลงโมเดล)
Model Drift (หรือบางครั้งเรียกว่า Performance Drift หรือ Model Decay) หมายถึงการที่ประสิทธิภาพของโมเดลลดลงตามเวลา โดยไม่จำเป็นต้องมี Drift ในข้อมูลนำเข้าหรือความสัมพันธ์ แต่เกิดจากตัวโมเดลเองหรือปัจจัยภายนอกที่ทำให้โมเดลไม่สามารถทำงานได้ดีเหมือนเดิม มันเป็นผลกระทบที่เกิดขึ้นหลังจาก Drift อื่นๆ หรือจากปัญหาภายในโมเดล เช่น overfit หรือ underfit ที่ปรากฏชัดเมื่อเวลาผ่านไป

**สาเหตุหลัก:**
- **การเสื่อมสภาพของโมเดล (Model Aging):** โมเดลที่ฝึกแล้วอาจ overfit กับข้อมูลเก่า เมื่อข้อมูลใหม่เข้ามาแม้ไม่เปลี่ยน distribution มาก แต่โมเดลไม่ generalize ได้ดี
- **ผลกระทบจาก Drift อื่นๆ:** เช่น Data Drift หรือ Concept Drift ทำให้ accuracy ลดลง
- **ปัญหาทางเทคนิค:** เช่น การอัปเดตซอฟต์แวร์ที่เปลี่ยนการคำนวณ floating-point หรือ hardware ที่เปลี่ยนทำให้ผลลัพธ์ต่างไปเล็กน้อย
- **External Factors:** เช่น การเปลี่ยนกฎหมายหรือนโยบายที่ทำให้โมเดลไม่เหมาะสมอีก เช่น ในระบบให้สินเชื่อ หากกฎหมายเปลี่ยนเกณฑ์อนุมัติ โมเดลเก่าอาจให้ผลผิด

**ตัวอย่าง:**
- ในระบบพยากรณ์ราคาหุ้น โมเดลอาจทำงานดีในช่วงตลาดปกติ แต่เมื่อตลาดผันผวนจากเหตุการณ์อย่างสงคราม ประสิทธิภาพลดลง แม้ข้อมูลนำเข้ายังคล้ายเดิม แต่โมเดลไม่สามารถจับ pattern ใหม่ได้
- ในแชทบอท AI หากผู้ใช้เปลี่ยนรูปแบบคำถาม (เช่น ใช้ slang ใหม่) โมเดลอาจตอบผิดมากขึ้น แม้ concept เดิมยังอยู่ แต่ performance ลด

**วิธีตรวจจับ:**
- **Monitoring Metrics:** ติดตาม accuracy, precision, recall, F1-score หรือ AUC บนข้อมูล validation ชุดใหม่ หากลดลงเกิน threshold ถือเป็น Drift
- **A/B Testing:** เปรียบเทียบผลลัพธ์ระหว่างโมเดลเก่าและใหม่
- **Error Analysis:** วิเคราะห์ข้อผิดพลาด เช่น confusion matrix เพื่อดู pattern การผิดพลาดที่เพิ่มขึ้น
- **Tools:** ใช้ MLflow, TensorBoard หรือ Prometheus สำหรับ monitoring

**วิธีแก้ไข:**
- **Retraining หรือ Fine-Tuning:** อัปเดตโมเดลด้วยข้อมูลใหม่ โดยใช้ transfer learning เพื่อไม่ต้องฝึกจากศูนย์
- **Model Ensemble:** รวมหลายเวอร์ชันของโมเดลเพื่อความเสถียร
- **AutoML:** ใช้ระบบอัตโนมัติในการเลือกและฝึกโมเดลใหม่เมื่อ detect Drift
- **Version Control:** จัดการเวอร์ชันโมเดลเพื่อ rollback หากเวอร์ชันใหม่แย่กว่า

#### 3. Concept Drift (การเปลี่ยนแปลงแนวคิด)
Concept Drift หมายถึงการเปลี่ยนแปลงในความสัมพันธ์พื้นฐานระหว่างข้อมูลนำเข้า (input) และผลลัพธ์ (output) หรือ target variable โดยที่ distribution ของข้อมูลนำเข้าอาจไม่เปลี่ยน แต่ "concept" หรือกฎที่กำหนด output เปลี่ยนไป สาเหตุหลักคือโลกจริงที่เปลี่ยนแปลง ทำให้สมมติฐานเดิมของโมเดลไม่เป็นจริงอีก

**สาเหตุหลัก:**
- **Real-World Changes:** เช่น พฤติกรรมมนุษย์เปลี่ยน เช่น ในระบบแนะนำหนัง ผู้ชมอาจเปลี่ยนรสนิยมจาก action ไปเป็น drama ตามกระแสสังคม
- **Adversarial Attacks:** ผู้ไม่หวังดีเปลี่ยนข้อมูลเพื่อหลอกโมเดล เช่น ในระบบตรวจจับสแปม อีเมลสแปมเปลี่ยนรูปแบบเพื่อหลบเลี่ยง
- **Policy Changes:** เช่น ในระบบแพทย์ หากนิยามโรคเปลี่ยน (เช่น COVID variants) ความสัมพันธ์ระหว่างอาการและการวินิจฉัยเปลี่ยน
- **Types of Concept Drift:** 
  - Sudden Drift: เปลี่ยนฉับพลัน เช่น จากเหตุการณ์ภัยพิบัติ
  - Gradual Drift: ค่อยๆ เปลี่ยน เช่น การเปลี่ยนรสนิยมตามเวลา
  - Incremental Drift: เปลี่ยนทีละน้อยซ้ำๆ
  - Recurring Drift: เปลี่ยนแล้วกลับมาเดิม เช่น ตามฤดูกาล

**ตัวอย่าง:**
- ในระบบตรวจจับการฉ้อโกง หากมิจฉาชีพเปลี่ยนวิธีโกงจากใช้บัตรปลอมไปเป็น phishing online ความสัมพันธ์ระหว่าง feature (เช่น จำนวนธุรกรรม) และ label (ฉ้อโกงหรือไม่) เปลี่ยนไป
- ในระบบพยากรณ์สภาพอากาศ หาก climate change ทำให้ pattern ฝนตกเปลี่ยน Concept Drift เกิดขึ้นเพราะกฎฟิสิกส์เดิมไม่แม่นยำอีก

**วิธีตรวจจับ:**
- **Page-Hinkley Test หรือ ADWIN:** อัลกอริทึมสำหรับ detect change point ใน stream data
- **Drift Detection Methods (DDM, EDDM):** ติดตาม error rate หากเพิ่มขึ้นอย่างมีนัยสำคัญ ถือเป็น Drift
- **Label Monitoring:** เปรียบเทียบ predicted label กับ actual label (ถ้ามี) เพื่อดู shift
- **Tools:** ใช้ River (ไลบรารีสำหรับ online ML) หรือ Scikit-Multiflow

**วิธีแก้ไข:**
- **Online Learning:** ฝึกโมเดลแบบต่อเนื่องกับข้อมูลใหม่ เช่น ใช้ incremental algorithms อย่าง Hoeffding Tree
- **Adaptive Models:** ใช้ window-based approach เช่น sliding window เพื่อลืมข้อมูลเก่าและเรียนรู้ใหม่
- **Drift Adaptation:** เมื่อ detect แล้ว retrain เฉพาะส่วนที่เปลี่ยน หรือใช้ meta-learning
- **Human-in-the-Loop:** ให้มนุษย์ตรวจสอบและ label ข้อมูลใหม่เพื่อปรับ concept

### สรุปและคำแนะนำ
Data Drift มุ่งเน้นที่การเปลี่ยนข้อมูลนำเข้า, Model Drift ที่ประสิทธิภาพโมเดลโดยรวม และ Concept Drift ที่ความสัมพันธ์พื้นฐาน ทั้งสามอย่างเชื่อมโยงกันและอาจเกิดพร้อมกัน การจัดการ Drift เป็นส่วนสำคัญของ MLOps (Machine Learning Operations) เพื่อให้โมเดลใช้งานได้ยาวนาน หากไม่ตรวจจับและแก้ไข อาจนำไปสู่ความล้มเหลว เช่น ในระบบ autonomous driving ที่ Drift อาจก่ออุบัติเหตุ

